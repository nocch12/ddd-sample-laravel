# ポイント設定
point_settings:
  columns:
    id: # ポイント設定コード
    begin: dateTime # 適用開始 
    end: dateTime # 適用終了
    point_rate: # ポイント付与率
      type: double
      args: 
        - 4
        - 1
# 支払い方法
payment_methods:
  columns:
    id: unsignedBigInteger # 支払い方法コード
    name: string # 支払い方法名
  indexes:
    - columns: [id]
      type: primary
# 支払い方法
payment_method_point_setting:
  columns:
    payment_method_id: unsignedBigInteger # 支払い方法コード
    point_setting_id: unsignedBigInteger # 支払い方法コード
  indexes:
    - columns: [payment_method_id, point_setting_id]
      type: unique
      name: payment_method_point_setting_unique
  foreign_keys:
    - columns: [payment_method_id]
      references: [id]
      table: payment_methods
    - columns: [point_setting_id]
      references: [id]
      table: point_settings
# 支払い
payments:
  columns:
    id: # レシート番号
    user_id: unsignedBigInteger # 会員コード
    shop_id: unsignedBigInteger # 店舗
    payed_at: dateTime # 支払日
    used_point: # ポイント利用
      type: double
      args: 
        - 8
        - 3
    timestamps:
  foreign_keys:
    - columns: [shop_id]
      references: [id]
      table: shops
# 支払い方法明細
payment_detail_methods:
  columns:
    id:
    payment_id: unsignedBigInteger # 支払いコード
    method_id: unsignedBigInteger # 支払い方法コード
    payment_amount: unsignedInteger # 支払い金額
    assigned_point: # 付与ポイント
      type: double
      args:
        - 8
        - 3
    timestamps:
  foreign_keys:
    - columns: [payment_id]
      references: [id]
      table: payments
    - columns: [method_id]
      references: [id]
      table: payment_methods
# 支払い商品明細
payment_detail_items:
  columns:
    id:
    payment_id: unsignedBigInteger # 支払いコード
    item_id: unsignedBigInteger # 商品
    unit_price: unsignedInteger # 商品単価
    quantity: unsignedInteger # 個数
    assigned_point: # 付与ポイント
      type: double
      args:
        - 8
        - 3
    timestamps:
  foreign_keys:
    - columns: [payment_id]
      references: [id]
      table: payments
    - columns: [item_id]
      references: [id]
      table: company_items